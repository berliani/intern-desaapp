<?php
namespace App\IMS;

class EnkripsiIMS 
{ 
	private const QN7qv = "\x61\145\163\55\62\x35\66\55\147\x63\x6d"; private string $PBswI; 
	public function __construct(string $SzOYp) { goto aMk9K; JWVzk: u2ZM1: goto Y54Uz; vZZcW: throw new Exception("\x4b\x75\x6e\x63\x69\x20\x65\x6e\153\x72\x69\160\x73\x69\40\150\141\x72\165\163\40\164\145\160\141\164\40\63\62\40\142\x79\x74\x65\x73\x2e"); goto JWVzk; aMk9K: if (!(mb_strlen($SzOYp, "\x38\x62\x69\164") !== 32)) { goto u2ZM1; } goto vZZcW; Y54Uz: $this->PBswI = $SzOYp; goto gMD2w; gMD2w: } 
	public static function generateKey() : string { return bin2hex(random_bytes(32)); } 
	public function encrypt(string $Bk8wS) : string { goto xLZqd; tOYF8: $w2Qvl = ["\166" => 1, "\x61" => self::QN7qv, "\x69\x76" => self::b64u($bQ9FH), "\164" => self::b64u($u4P_m), "\143" => self::b64u($YlKgf)]; goto uoBTf; uoBTf: return "\x76\x31\x2e" . self::b64u(json_encode($w2Qvl, JSON_UNESCAPED_SLASHES)); goto r5x00; oLI4u: $YlKgf = openssl_encrypt($Bk8wS, self::QN7qv, $this->PBswI, OPENSSL_RAW_DATA, $bQ9FH, $u4P_m, '', 16); goto ARx5R; QBLBR: $bQ9FH = random_bytes($zydbn); goto Gg3uk; Gg3uk: $u4P_m = ''; goto oLI4u; XHASd: GnR0T: goto tOYF8; ARx5R: if (!($YlKgf === false)) { goto GnR0T; } goto SfrIj; SfrIj: throw new RuntimeException("\x45\x6e\153\162\x69\x70\163\151\x20\x67\141\147\x61\x6c\56"); goto XHASd; xLZqd: $zydbn = openssl_cipher_iv_length(self::QN7qv); goto QBLBR; r5x00: } 
	public function decrypt(string $zgTde) : string { goto OMHEt; w51v3: return $Bk8wS; goto Gv8l3; amRpH: throw new RuntimeException("\104\145\x6b\x72\x69\x70\163\x69\x20\147\141\147\x61\x6c\x2e"); goto ryfpy; sJKGm: $qzZId = json_decode($wtLQf, true); goto Df7vU; ApU_w: throw new RuntimeException("\x50\x61\x79\x6c\157\x61\x64\x20\x74\151\x64\x61\x6b\40\x76\x61\154\151\144\x2e"); goto nVqCE; HZsR7: pMo4G: goto iMSt_; WeA3u: Yrxtn: goto WovtH; d1wIq: $bQ9FH = self::b64u_decode($qzZId["\x69\x76"] ?? ''); goto CvuuA; lXteY: throw new RuntimeException("\x50\141\x79\154\157\141\144\x20\x74\x69\x64\141\x6b\40\x6c\145\x6e\x67\x6b\141\160\x2e"); goto WeA3u; nVqCE: KXJLF: goto d1wIq; cIBd3: throw new RuntimeException("\x54\x6f\x6b\x65\x6e\x20\x74\151\x64\x61\x6b\40\x76\141\154\x69\x64\56"); goto HZsR7; ryfpy: ESCAn: goto w51v3; hxWdw: if (!($Bk8wS === false)) { goto ESCAn; } goto amRpH; SugGJ: if (!($wtLQf === false)) { goto pAPlb; } goto HLzce; HLzce: throw new RuntimeException("\x54\157\153\x65\x6e\40\153\x6f\x72\x75\x70\56"); goto heKCK; heKCK: pAPlb: goto sJKGm; Lu_EK: if (!(!$bQ9FH || !$u4P_m || !$HVhDj)) { goto Yrxtn; } goto lXteY; iMSt_: $wtLQf = self::b64u_decode(substr($zgTde, 3)); goto SugGJ; UQ31I: $HVhDj = self::b64u_decode($qzZId["\143"] ?? ''); goto Lu_EK; WovtH: $Bk8wS = openssl_decrypt($HVhDj, self::QN7qv, $this->PBswI, OPENSSL_RAW_DATA, $bQ9FH, $u4P_m); goto hxWdw; OMHEt: if (!(strpos($zgTde, "\166\x31\56") !== 0)) { goto pMo4G; } goto cIBd3; CvuuA: $u4P_m = self::b64u_decode($qzZId["\164"] ?? ''); goto UQ31I; Df7vU: if (!(!is_array($qzZId) || ($qzZId["\166"] ?? null) !== 1)) { goto KXJLF; } goto ApU_w; Gv8l3: } 
	private static function b64u(string $cZ06e) : string { return rtrim(strtr(base64_encode($cZ06e), "\53\x2f", "\55\x5f"), "\x3d"); } 
	private static function b64u_decode(string $AZyM4) : string|false { return base64_decode(strtr($AZyM4, "\x2d\137", "\53\x2f")); } 
}